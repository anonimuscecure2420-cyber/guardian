#!/bin/shnano comandos_git.txt
# --- FUNCIONES DE COLOR ---
ok()   { echo -e "\033[1;32m[OK]\033[0m $1"; }
warn() { echo -e "\033[1;33m[WARN]\033[0m $1"; }
info() { echo -e "\033[1;34m[INFO]\033[0m $1"; }

# --- VERIFICACICN DE CABECERAS DE SEGURIDAD CON CURL ---
check_headers() {
  url="$1"
  info "Analizando cabeceras de seguridad para $url..."

  # Obtenemos cabeceras y seguimos redirecciones
  response=$(curl -IsL --insecure "$url")

  echo "$response" | grep -i "Strict-Transport-Security" >/dev/null \
    && ok "HSTS habilitado" \
    || warn "HSTS NO habilitado"

  echo "$response" | grep -i "Content-Security-Policy" >/dev/null \
    && ok "CSP habilitado" \
    || warn "CSP NO habilitado"

  echo "$response" | grep -i "X-Frame-Options" >/dev/null \
    && ok "X-Frame-Options habilitado" \
    || warn "X-Frame-Options NO habilitado"

  echo "$response" | grep -i "X-Content-Type-Options" >/dev/null \
    && ok "X-Content-Type-Options habilitado" \
    || warn "X-Content-Type-Options NO habilitado"

  echo "$response" | grep -i "Referrer-Policy" >/dev/null \
    && ok "Referrer-Policy habilitado" \
    || warn "Referrer-Policy NO habilitado"

  ok "AnC!lisis de cabeceras completado."
}
